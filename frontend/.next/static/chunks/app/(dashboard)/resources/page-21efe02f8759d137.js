(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71],{6610:function(e,s,r){Promise.resolve().then(r.bind(r,3504))},3504:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return N}});var t=r(7437),a=r(2265),l=r(2381),c=r(279),i=r(9820),n=r(641),o=r(1817),d=r(3340),m=r(3448);function u(e){let{onCreateResources:s}=e,[r,u]=(0,a.useState)(""),[x,h]=(0,a.useState)(!1),[p]=(0,a.useState)([]),[f,j]=(0,a.useState)(null),{toast:g}=(0,d.pm)(),v=async e=>{if(e.preventDefault(),j(null),!r.trim()){j("Please enter a subject");return}h(!0);try{await s(r.trim()),u(""),g({variant:"success",title:"Success",description:"Resources generated successfully"})}catch(e){"object"==typeof e&&null!==e&&"response"in e&&"object"==typeof e.response&&null!==e.response&&"data"in e.response&&"object"==typeof e.response.data&&null!==e.response.data&&"error"in e.response.data&&"RESOURCE_EXISTS"===e.response.data.error&&"message"in e.response.data&&j(e.response.data.message)}finally{h(!1)}};return(0,t.jsx)("div",{className:"w-full bg-[#F2EDE0] p-4 sm:p-6 border-2 border-b-4 border-r-4 border-black rounded-xl",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("form",{onSubmit:v,className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(c.I,{type:"text",placeholder:"Enter a topic to find learning resources...",value:r,onChange:e=>{u(e.target.value),j(null)},className:(0,m.cn)("bg-white border-2 border-black text-gray-900 placeholder-gray-500 text-base sm:text-lg p-6 rounded-xl h-auto",f&&"border-red-500 focus-visible:ring-red-500")}),f&&(0,t.jsx)("p",{className:"text-sm text-red-500 mt-1",children:f})]}),(0,t.jsx)(l.z,{type:"submit",disabled:x||!r.trim(),className:"w-full sm:w-auto flex justify-center items-center text-base sm:text-lg py-8 mt-1 px-8 rounded-xl",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):"Generate Resources"})]}),!f&&p.length>0&&(0,t.jsx)(n.x,{className:"h-[calc(100vh-400px)] sm:h-[calc(100vh-300px)] w-full",children:(0,t.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:gap-10",children:p.map((e,s)=>(0,t.jsxs)(i.Zb,{className:"bg-white border-2 border-black border-b-4 border-r-4",children:[(0,t.jsxs)(i.Ol,{className:"p-4 sm:p-6",children:[(0,t.jsx)(i.ll,{className:"text-lg sm:text-xl text-gray-800",children:e.title}),(0,t.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:e.type})]}),(0,t.jsxs)(i.aY,{className:"p-4 sm:p-6",children:[(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mb-4",children:e.description}),(0,t.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-[#7fb236] hover:text-[#6f9826] hover:underline text-sm sm:text-base",children:"Learn More â†’"})]})]},s))})})]})})}var x=r(9174),h=r(767);let p=(0,r(9205).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var f=r(3227);function j(e){let{resource:s,onDelete:r}=e,{toast:c}=(0,d.pm)(),[n,o]=(0,a.useState)(!1),m=async()=>{try{o(!0),await f.x.deleteCuratedResources(s._id),r(s._id),c({variant:"success",title:"Success",description:"Resources deleted successfully"})}catch(e){c({variant:"error",title:"Error",description:"Failed to delete resources"})}finally{o(!1)}},u=s.lastUpdated?new Date(s.lastUpdated).toLocaleDateString():"Date not available";return(0,t.jsxs)(i.Zb,{className:"w-full mt-4 sm:mt-8",children:[(0,t.jsxs)(i.Ol,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-4 sm:space-y-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(i.ll,{className:"text-xl sm:text-2xl font-bold break-words",children:["Resources for ",s.topic]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2",children:[(0,t.jsx)(x.C,{variant:"outline",className:"text-sm",children:u}),(0,t.jsxs)(x.C,{variant:"outline",className:"text-sm",children:[s.resources.length," Resources"]})]})]}),(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.vW,{asChild:!0,children:(0,t.jsx)(l.z,{variant:"destructive",disabled:n,className:"w-full sm:w-auto hover:bg-red-500",children:"Delete Resources"})}),(0,t.jsxs)(h._T,{className:"sm:max-w-[425px]",children:[(0,t.jsxs)(h.fY,{children:[(0,t.jsx)(h.f$,{children:"Are you sure?"}),(0,t.jsx)(h.yT,{children:"This action cannot be undone. This will permanently delete these curated resources."})]}),(0,t.jsxs)(h.xo,{className:"flex-col sm:flex-row gap-2 sm:gap-0",children:[(0,t.jsx)(h.le,{className:"w-full sm:w-auto",children:"Cancel"}),(0,t.jsx)(h.OL,{onClick:m,className:"w-full sm:w-auto hover:bg-red-500",children:"Delete"})]})]})]})]}),(0,t.jsx)(i.aY,{children:(0,t.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:s.resources.map(e=>(0,t.jsxs)(i.Zb,{className:"bg-muted",children:[(0,t.jsx)(i.Ol,{className:"p-4 sm:p-6",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0",children:[(0,t.jsx)(i.ll,{className:"text-base sm:text-lg font-semibold break-words",children:e.title}),(0,t.jsx)(x.C,{className:"text-xs sm:text-sm",children:e.type})]})}),(0,t.jsxs)(i.aY,{className:"space-y-4 p-4 sm:p-6",children:[(0,t.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground break-words",children:e.description}),(0,t.jsxs)(l.z,{variant:"outline",className:"w-full text-sm sm:text-base py-2 sm:py-4",onClick:()=>window.open(e.link,"_blank"),children:["Visit Resource ",(0,t.jsx)(p,{className:"ml-2 h-3 w-3 sm:h-4 sm:w-4"})]})]})]},e._id))})})]})}var g=r(1593),v=r(9140),b=r(605),y=r(2813);function N(){var e;let{data:s}=(0,b.useSession)(),[r,l]=(0,a.useState)([]),[c,i]=(0,a.useState)(!0),[n,o]=(0,a.useState)(1),{toast:m}=(0,d.pm)(),x=(0,a.useCallback)(async()=>{var e;if(null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.id)try{let e=await f.x.getCuratedResources(s.user.id);if(console.log("Fetched resources data:",e),e.error){console.error("API returned error:",e.error),m({variant:"error",title:"Error",description:"Failed to fetch resources. Please try again."}),l([]);return}if(e.resources&&Array.isArray(e.resources)){let s=e.resources.filter(e=>e&&e._id&&e.topic&&Array.isArray(e.resources));console.log("Valid resources:",s),l(s)}else console.error("Invalid resources data structure:",e),l([])}catch(e){console.error("Error fetching resources:",e),m({variant:"error",title:"Error",description:"Failed to fetch resources. Please try again."}),l([])}finally{i(!1)}},[null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.id,m]);(0,a.useEffect)(()=>{x()},[x]);let h=e=>{l(s=>s.filter(s=>s._id!==e)),m({variant:"success",title:"Success",description:"Resource deleted successfully."})},p=async e=>{var r,t,a;if(null==s?void 0:null===(r=s.user)||void 0===r?void 0:r.id)try{await f.x.createCuratedResources(s.user.id,e),m({variant:"success",title:"Success",description:"Resources created successfully."}),x()}catch(e){if(console.error("Error creating resources:",e),e&&"object"==typeof e&&"status"in e&&(429===e.status||413===e.status)){let s=Math.ceil((e.retryAfter||60)/60);m({variant:"error",title:"Rate Limit Exceeded",description:"Please try again in ".concat(s," minute").concat(s>1?"s":"",". Our AI service has reached its limit.")});return}if(e&&"object"==typeof e&&"response"in e&&(null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.error)==="RESOURCE_EXISTS"){m({variant:"default",title:"Resources Already Exist",description:e.response.data.message||"You already have resources for this subject."});let s=document.getElementById("stored-resources");s&&s.scrollIntoView({behavior:"smooth"});return}m({variant:"error",title:"Error",description:e instanceof Error?e.message:"Failed to create resources. Please try again."})}},N=Math.ceil(r.length/5),w=(n-1)*5,E=r.slice(w,w+5);return(0,t.jsxs)("div",{className:"p-4 sm:p-6 md:p-8",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-0 mb-6 sm:mb-8",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Resource Curator"}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"text-xs sm:text-sm text-gray-600",children:"Find and manage learning resources"})})]}),(0,t.jsx)("div",{className:"w-full max-w-10xl mx-auto",children:(0,t.jsx)(u,{onCreateResources:p})}),c?(0,t.jsxs)("div",{className:"mt-8 sm:mt-12",children:[(0,t.jsx)(g.Z,{className:"my-6 sm:my-8"}),(0,t.jsx)(v.O,{className:"h-6 sm:h-8 w-36 sm:w-48 mb-4 sm:mb-6"}),(0,t.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,t.jsx)(v.O,{className:"h-[150px] sm:h-[200px] w-full"}),(0,t.jsx)(v.O,{className:"h-[150px] sm:h-[200px] w-full"})]})]}):(0,t.jsxs)("div",{id:"stored-resources",className:"mt-8 sm:mt-12",children:[(0,t.jsx)(g.Z,{className:"my-6 sm:my-8"}),(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6",children:"Your Curated Resources"}),r.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"space-y-4 sm:space-y-6",children:E.map(e=>(0,t.jsx)(j,{resource:e,onDelete:h},e._id))}),N>1&&(0,t.jsx)(y.z,{currentPage:n,totalPages:N,onPageChange:o})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("p",{children:"You haven't curated any resources yet."}),(0,t.jsx)("p",{className:"mt-2",children:"Use the form above to get personalized learning resources!"})]})]})]})}}},function(e){e.O(0,[310,137,605,314,343,998,971,117,744],function(){return e(e.s=6610)}),_N_E=e.O()}]);